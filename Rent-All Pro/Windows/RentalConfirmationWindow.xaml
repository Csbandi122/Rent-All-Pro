<Window x:Class="RentAllPro.Windows.RentalConfirmationWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Bérlés véglegesítése - Eszközbérlés támogatás" 
        Height="700" Width="800"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        Icon="../Images/logo.png">

    <Window.Resources>
        <!-- Stílusok -->
        <Style TargetType="TextBox">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Height" Value="35"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="Background" Value="#F8F9FA"/>
        </Style>

        <Style TargetType="Label">
            <Setter Property="Margin" Value="5,5,5,0"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>

        <Style TargetType="GroupBox">
            <Setter Property="Margin" Value="15"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BorderBrush" Value="#2E86AB"/>
            <Setter Property="BorderThickness" Value="2"/>
        </Style>

        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Background" Value="#2E86AB"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#1E5F7A"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SecondaryButton" TargetType="Button">
            <Setter Property="Background" Value="#F8F9FA"/>
            <Setter Property="Foreground" Value="#2E86AB"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="BorderBrush" Value="#2E86AB"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E9ECEF"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SuccessButton" TargetType="Button">
            <Setter Property="Background" Value="#28A745"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#1E7E34"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#2E86AB" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Logó -->
                <Image Grid.Column="0" 
                       Source="/Images/logo.png" 
                       Height="40" 
                       Width="40" 
                       Margin="0,0,15,0"
                       VerticalAlignment="Center"/>

                <!-- Cím -->
                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                    <TextBlock Text="Bérlés véglegesítése" 
                               FontSize="24" 
                               FontWeight="Bold" 
                               Foreground="White"/>
                    <TextBlock x:Name="txtCustomerInfo"
                               Text="Ügyfél: Loading..." 
                               FontSize="14" 
                               Foreground="#E9ECEF"/>
                </StackPanel>

                <!-- Összeg -->
                <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                    <TextBlock x:Name="txtTotalAmount"
                               Text="0 Ft" 
                               FontSize="20" 
                               FontWeight="Bold"
                               Foreground="White"
                               HorizontalAlignment="Right"/>
                    <TextBlock x:Name="txtDateInfo"
                               Text="2025.01.01 - 2025.01.01" 
                               FontSize="12" 
                               Foreground="#E9ECEF"
                               HorizontalAlignment="Right"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="20">

                <!-- Ügyfél adatok -->
                <GroupBox Header="👤 Ügyfél adatok">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Row="0" Grid.Column="0" Content="Teljes név:"/>
                        <TextBox Grid.Row="0" Grid.Column="1" x:Name="txtCustomerName"/>

                        <Label Grid.Row="1" Grid.Column="0" Content="Cím:"/>
                        <TextBox Grid.Row="1" Grid.Column="1" x:Name="txtCustomerAddress"/>

                        <Label Grid.Row="2" Grid.Column="0" Content="E-mail / Igazolvány szám:"/>
                        <TextBox Grid.Row="2" Grid.Column="1" x:Name="txtCustomerContact"/>
                    </Grid>
                </GroupBox>

                <!-- Bérlési adatok -->
                <GroupBox Header="📅 Bérlési adatok">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Row="0" Grid.Column="0" Content="Bérlés kezdete:"/>
                        <TextBox Grid.Row="0" Grid.Column="1" x:Name="txtStartDate"/>

                        <Label Grid.Row="1" Grid.Column="0" Content="Bérlési időtartam:"/>
                        <TextBox Grid.Row="1" Grid.Column="1" x:Name="txtRentalPeriod"/>

                        <Label Grid.Row="2" Grid.Column="0" Content="Fizetési mód:"/>
                        <TextBox Grid.Row="2" Grid.Column="1" x:Name="txtPaymentMethod"/>
                    </Grid>
                </GroupBox>

                <!-- Kiválasztott eszközök -->
                <GroupBox Header="🔧 Kiválasztott eszközök">
                    <ListView x:Name="lstSelectedEquipments"
                              Height="200"
                              IsEnabled="False">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Kód" Width="80" DisplayMemberBinding="{Binding Code}"/>
                                <GridViewColumn Header="Eszköz neve" Width="200" DisplayMemberBinding="{Binding Name}"/>
                                <GridViewColumn Header="Típus" Width="100" DisplayMemberBinding="{Binding Type}"/>
                                <GridViewColumn Header="Napi díj" Width="100" DisplayMemberBinding="{Binding DailyRate, StringFormat=N0 Ft}"/>
                                <GridViewColumn Header="Összesen" Width="100" DisplayMemberBinding="{Binding TotalPrice, StringFormat=N0 Ft}"/>
                            </GridView>
                        </ListView.View>
                    </ListView>
                </GroupBox>

                <!-- PDF szerződés generálás -->
                <!-- Word szerződés generálás -->
                <GroupBox Header="📄 Szerződés">
                    <StackPanel>
                        <TextBlock Text="1. Generálja le a szerződést Word formátumban"
                   Margin="5"
                   FontSize="12"/>

                        <Button x:Name="btnGeneratePDF" 
                Content="📄 Word szerződés generálása" 
                Style="{StaticResource PrimaryButton}"
                Click="BtnGeneratePDF_Click"
                HorizontalAlignment="Left"/>

                        <Separator Margin="0,10"/>

                        <TextBlock Text="2. Nyissa meg a szerződést aláírásra Word-ben"
                   Margin="5"
                   FontSize="12"/>

                        <Button x:Name="btnOpenPDF" 
                Content="📖 Word megnyitása aláírásra" 
                Style="{StaticResource SecondaryButton}"
                Click="BtnOpenPDF_Click"
                IsEnabled="False"
                HorizontalAlignment="Left"/>

                        <Separator Margin="0,10"/>

                        <CheckBox x:Name="chkContractSigned"
                  Content="✅ Szerződés aláírva és PDF-ként mentve"
                  FontWeight="Bold"
                  FontSize="14"
                  Margin="5,10"
                  IsEnabled="False"
                  Checked="ChkContractSigned_Checked"/>
                    </StackPanel>
                </GroupBox>

            </StackPanel>
        </ScrollViewer>

        <!-- Footer Buttons -->
        <Border Grid.Row="2" Background="#F8F9FA" Padding="20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Left">
                    <Button x:Name="btnBack" 
                            Content="◀ Vissza az eszközökhöz" 
                            Style="{StaticResource SecondaryButton}"
                            Click="BtnBack_Click"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button x:Name="btnCancel" 
                            Content="Mégse" 
                            Style="{StaticResource SecondaryButton}"
                            Click="BtnCancel_Click"/>
                    <Button x:Name="btnFinalize" 
                            Content="💾 Bérlés véglegesítése" 
                            Style="{StaticResource SuccessButton}"
                            Click="BtnFinalize_Click"
                            IsEnabled="False"/>
                </StackPanel>
            </Grid>
        </Border>

    </Grid>
</Window>